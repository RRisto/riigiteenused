{
    "contents" : "#andmed pikaks, võtab eelenvad funktsioonid kokku, iga\n#aasta andmed teeb pikaks\n#' @export\nandmedPikaks=function(andmedLai) {\n  vars=names(andmedLai) %in% c(\"regulatsioon\", \"objectId\", \"eluarisyndmus\", \"kirjeldus\",\n                               \"eeltingimus\", \"jareltingimus\", \"createdAt\",\n                               \"updatedAt\", \"keel\", \"osakondyksus\", \"omanikunimi\",\n                               \"omanikutelefon\",\"omanikuemail\",\n                               \"konfinfo\", \"seotuddokumendid\", \"seisund\",\n                               \"muudatustvajav\", \"aegumisekpv\", \"funktsioon\",\n                               \"veebiaadress\")\n  #eemaldame muutujad\n  andmedLai=andmedLai[,!vars]\n  #aastate põhjal teeme andmed 2-ks (kui aastaid rohkem siis vastavalt sellele\n  #arv muutub)\n  andmedLai2015=andmedLai[, !grepl(\"empty.|2011.|2013.|2012.|2014.\",\n                                   names(andmedLai))]\n  andmedLai2014=andmedLai[, !grepl(\"empty.|2011.|2013.|2012.|2015.\",\n                                   names(andmedLai))]\n  andmedLai2013=andmedLai[, !grepl(\"empty.|2011.|2012.|2014.|2015.\",\n                                   names(andmedLai))]\n  andmedLai2012=andmedLai[, !grepl(\"empty.|2011.|2013.|2014.|2015.\",\n                                   names(andmedLai))]\n  andmedLai2011=andmedLai[, !grepl(\"empty.|2014.|2013.|2012.|2015.\",\n                                   names(andmedLai))]\n  andmedLaiEmpty=andmedLai[, !grepl(\"2014.|2011.|2013.|2012.|2015.\",\n                                    names(andmedLai))]\n  puhas2015=korrastaja(andmedLai2015, \"2015.\", \"2015\")\n  puhas2014=korrastaja(andmedLai2014, \"2014.\", \"2014\")\n  puhas2013=korrastaja(andmedLai2013, \"2013.\", \"2013\")\n  puhas2012=korrastaja(andmedLai2012, \"2012.\", \"2012\")\n  puhas2011=korrastaja(andmedLai2011, \"2011.\", \"2011\")\n  puhasEmpty=korrastaja(andmedLaiEmpty, \"empty.\", \"pole moodetud\")\n  #paneme andmed kokku\n  andmedPikk=rbind(puhas2015, puhas2014,puhas2013,puhas2012, puhas2011,puhasEmpty)\n  #eemaldame read, kus pole linki\n  andmedPikk=andmedPikk[!is.na(andmedPikk$link),]\n  andmedPikk\n}\n\n#sama funktsioon, kuid kasutab data.table'i formaati\n# @export\nandmedPikaksDT=function(andmedLai) {\n  library(data.table)\n  andmed=data.table(andmedLai)\n  andmedLai2015=andmed[, !grepl(\"empty.|2011.|2013.|2012.|2014.\",\n                                names(andmed)), with=F]\n  andmedLai2014=andmed[, !grepl(\"empty.|2011.|2013.|2012.|2015.\",\n                                names(andmed)), with=F]\n  andmedLai2013=andmed[, !grepl(\"empty.|2011.|2012.|2014.|2015.\",\n                                names(andmed)), with=F]\n  andmedLai2012=andmed[, !grepl(\"empty.|2011.|2013.|2014.|2015.\",\n                                names(andmed)), with=F]\n  andmedLai2011=andmed[, !grepl(\"empty.|2014.|2013.|2012.|2015.\",\n                                names(andmed)), with=F]\n  andmedLaiEmpty=andmed[, !grepl(\"2014.|2011.|2013.|2012.|2015.\",\n                                 names(andmed)), with=F]\n\n  puhas2015=korrastajaDT(andmedLai2015, \"2015.\", \"2015\")\n  puhas2014=korrastajaDT(andmedLai2014, \"2014.\", \"2014\")\n  puhas2013=korrastajaDT(andmedLai2013, \"2013.\", \"2013\")\n  puhas2012=korrastajaDT(andmedLai2012, \"2012.\", \"2012\")\n  puhas2011=korrastajaDT(andmedLai2011, \"2011.\", \"2011\")\n  puhasEmpty=korrastajaDT(andmedLaiEmpty, \"empty.\", \"pole moodetud\")\n  andmedPikk=rbind(puhas2015, puhas2014, puhas2013, puhas2012,puhas2011,\n                   puhasEmpty)\n  andmedPikk[, value:=as.numeric(as.character(value))]\n}\n",
    "created" : 1453812617420.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "132186300",
    "id" : "8D8C89FF",
    "lastKnownWriteTime" : 1459712162,
    "path" : "~/R/riigiteenused/R/andmedPikaks.R",
    "project_path" : "R/andmedPikaks.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}